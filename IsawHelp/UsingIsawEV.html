<HTML><HEAD><TITLE>Untitled Document</TITLE>
<BODY>
<BR>
<CENTER><B><FONT size=+2>Using IsawEV (Please Read)</FONT></B></CENTER>
<BR>
<HR align=left>

<P>
IsawEV provides a 3D scatter plot of detected neutrons, mapped to reciprocal
space, and conventional line graphs of intensity vs |Q| and intensity vs
d-spacing.  The data may come from SNS raw event files, or from live data
on the instrument computer.  IsawEV also supports finding and indexing peaks
in single crystal data.
</P>

<P>
IsawEV requires additional geometry information about the instrument to 
be able to map events to reciprocal space.  Currently, default geometry 
information is provided for TOPAZ, SNAP, PG3, ARCS, SEQUOIA and CNCS by
files in the InstrumentInfo/SNS/<instrument name> sub-directory of the
ISAW distribution directory.  The needed geometry files can also be specified 
on the Load Data form, if the default files are not provided for an 
instrument, or if it is necessary to load data from an event file made with
an updated (or previous) instrument geometry.
</P>

<P>
<FONT size=+1>Loading a File</FONT>
<BR>
<BR>
To load data from a *neutron_event.dat FILE, press the "Load Data" button 
on the left side of the control panel.  
Make sure the "From File" tab is at the front, then press the 
"Neutron Event File" button to select the raw event data file to load.
For SNAP, an incident spectrum file is also in the same 
directory.  If a newer version is available, it may be specified by
pressing the incident spectrum button.  NOTE: The event file is the only 
file that needs to be specified, if the default geometry is OK.  When the
file(s) have been specified, press the "Load" button at the bottom of the
form to actually load the file.  Events should start to show up in the
3D viewer, within a few seconds of starting to load the data.  The number
of events to show in 3D must be limited to avoid overloading the graphics
hardware.
</P>


<P>
<FONT size=+1>Viewing Live Data</FONT>
<BR>
<BR>
To view live data on the instrument computer, select the "From Live Data"
tab, instead of the "From File" tab.   You must also select the
instrument name from the drop down menu.  To start listening for live events, 
press the Load button at the bottom of the panel.  In order to adjust the 
3D view temporarily stop 
listening for events by pressing the "Pause" button.  To resume
listening for live events, press the "Continue" button.  To clear out all 
loaded events and stop listening for new events, press the
"Pause & Clear" button.  Press "Continue" to start listening for and
accumulating new events.
<BR>
<BR>
Reasonable default values are provided for the Calibration File, Bank File,
etc.  If any of these options are changed, the "Load" button at the bottom
of the form must be pressed again to re-initialize the internal data
structures with the new values.  The Continue button will not make any such
changes.
<BR>
<BR>
Live events can be obtained from the
"Live Data Server" that should be running on all SNS instrument computers.
IF the Live Data Server is not running, and IsawEV is running on a 
computer that is directly connected to the DAS network, then ISAW can get
events directly from the DAS.  NOTE: If the Live Data Server is running
on the instrument computer, and IsawEV is running on the instrument computer
then IsawEV will NOT be able to get events directly, but MUST get events 
that are passed to it by the Live Data Server.
<BR>
<BR>
By default, IsawEV will automatically try to get events from the Live Data 
Server, running on the instrument computer for the specified instrument.
Selecting the "Only Connect to Port" option will instead try to get live
events on the specified port.  In that case either the Live Data Server
must be manually set to send events to that specified port, OR if the 
Live Data Server is not running then the port must be set to 8002 to get
events directly from the DAS on the DAS network.
<BR>
<BR>
NOTE: For convenience, the rate at which live events are being received is
displayed on the "From Live Data" tab.  The value is updated every few 
seconds and shows the average number of "Counts Per Second" during the 
previous second.  The time of the measurement is also displayed.  If events
are no longer being received, the time of the last count rate measurement
is shown.
</P>


<P>
<FONT size=+1>Maximum Q range</FONT>
<BR>
<BR>
For either file or live data, the maximum |Q| value to be loaded can be 
specified.  Specifying this can help omit noisy data values at large |Q|.
This is particularly helpful when trying to find peaks in single crystal 
data.  Eliminating the large |Q| values often allows setting a lower 
threshold for peaks to find more valid peaks, without finding a lot of
spurious peaks in the noisy high |Q| range.
</P>


<P>
<FONT size=+1>Absorption Correction</FONT>
<BR>
<BR>
The data displayed in the 3D event view consists of "fractional" events,
obtained by applying corrections to the data similar to those carried out
by the ANVRED program.  In particular, a spherical absorption correction
can be applied to the data by specifying a sample radius that is greater
than zero.  No absorption correction will be done if the radius is zero or
negative.  In addition to the sample radius, values for the scattering mu
and for the absorption mu coefficients can be specified.  As a first,
rough approximation, these can be taken to be 1. 
</P>


<P>
<FONT size=+1>Using the 3D View</FONT>
<BR>
<BR>
The 3D window shows a scatter plot of the weighted events mapped to reciprocal
space.  When the 3D view is NOT being updated with new live data, you can 
interact with this view in several ways.
<BR>
<BR>
1. Press the left mouse button and drag the mouse to rotate the view
the current view reference point.
<BR>
<BR>
2. Press the middle mouse button and drag up/down on the screen to move
in and out of the scene.  In this mode, the center of the view volume,
marked by the small coordinate axes, moves along with the observer.
<BR>
<BR>
3. If you have a mouse with a middle "wheel" then rolling the wheel
will move the observer closer to or farther from the center of the view, 
marked by the small coordinate axes.
<BR>
<BR>
4. Press the right mouse button and drag to pan across the 3D scene.
<BR>
<BR>
5. The initial view is a perspective view.  This can be switched to an
Orthographic view by selecting that option on the "Draw Options" panel
and pressing "Apply".  The Orthographic view is most useful for verifying
that diffraction peaks from a single crystal "line up" and form a lattice.
<BR>
<BR>
NOTE: Since Operations 1. and 2. also move the center of the view 
in and out of the screen, the center of rotations changes.  All rotations
are about the center of view, marked by the small coordinate axes.
<BR>
<BR>
You can also click on an event in the 3D view and see information 
about that event, such as the detector pixel, Q, time-of-flight, etc.
This information is displayed in a panel that is made visible by
pressing the "Selected Point" panel on the left side of the 
display.  It may be easier to select points if the point size is 
increased from 1 to 3  using the Point Size control on the Drawing Options
form.
</P>

<P>
<FONT size=+1>Color Scale (IMPORTANT)</FONT>
<BR>
<BR>
The color of the events displayed is based on the histogram value for
that position in reciprocal space, and a color scale controlled from 
a panel activated by pressing the "Color Scale" button.  The most
IMPORTANT role of the color scale is to provide a threshold below
which events will NOT be marked in 3D.  If all events are shown, the
3D space fills with events and it is difficult to see any patterns
present in the data.  The "Data Min" on the Color Edit Panel should
be set high enough so that excessive background noise s not shown, 
and low enough to see patterns in the data such as diffraction rings
or isolated peaks.  
</P>

<P>
<FONT size=+1>Q and D graphs</FONT>
<BR>
<BR>
Graphs of intensity vs |Q| and intensity vs d-spacing can be
displayed from the "Additional Views" panel.  The graphs can be
"popped up" or "popped down" using the "Show Q Graph" and 
"Show D Graph" check boxes.  The graphs are dynamically updated
when loading live data.  The graphs can use uniform bin sizes,
or bin sizes that keep delta_x/x constant, i.e. a "Log" scale.
The choice of using uniform or log binning must be made before 
events are loaded.  If this option is changed, the data file must be
reloaded, or the live event stream must be paused, cleared and restarted
to use the new binning scheme.
</P>
<P>
<FONT size=+1>Drawing Options</FONT>
<BR>
<BR>
Some drawing options may be useful and are controlled from the
"Draw Options" panel.  The most useful options are changing to
an Orthographic View (instead of than the default perspective view)
and changing the point size.  For example, if the scatter plot 
is very full of points it may help to set the Point Size down to 1.
After altering some draw options, press the Apply button at the
bottom of the panel to make them effective.
</P>

<P>
<FONT size=+1>Finding Peaks</FONT>
<BR>
<BR>
IsawEV maintains an underlying 512 megabyte histogram of events in 
reciprocal space.  The Find Peaks panel can be used to search through 
this histogram for local maxima.  The maximum number of peaks
to find and the minimum peak intensity can be specified to control the
find peaks process.  The peaks that are found will be marked on the
3D scatter plot.  By examining the 3D scatter plot it is possible to
see whether or not the peaks that were found form a lattice pattern.
Lowering the threshold, or increasing
the Max number of peaks will increase the number of points identified
as peaks.  If too many "noise" peaks are present (often at high |Q|)
the threshold should be raised and/or the number of peaks should be 
lowered.  This is useful for finding an appropriate set peaks for 
indexing SCD data.  
</P>

<P>
<FONT size=+1>Indexing Peaks</FONT>
<BR>
<BR>
Once peaks have been found, they can be indexed.  In particular,
two basic methods to get an initial orientation matrix and indexing 
are currently supported in IsawEV.  
One method requires good estimates of all six lattice parameters. 
This method is quite robust.  The other method attempts to index the 
peaks automatically.  The automatic method often produces better results
if reasonable estimates of the min and max for primitive cell edge lengths
are specified.  For example if the crystal should be cubic with a=b=c=5,
entering a min of 4 and a max of 6 should work well.  The autoindexing
method produces a (possibly long) list of orientation matrices to choose from.
If an orientation matrix is available in a file, the peaks can also be
indexed using that matrix.  For any of the indexing methods the 
quality of the indexing can be assessed by looking at the Peaks Info panel.
This panel shows how many peaks were indexed, and provides histograms
showing deviations of the indexed peaks from integer h, k and l values.
The list of peaks can also be displayed from this panel.  This information
can be written to a file using the "Write Peaks File" button on the 
"Find Peaks" panel.
</P>

<P>
<FONT size=+1>Choosing a Conventional Cell Type</FONT>
<BR>
<BR>
Once a reduced cell has been determined, the "Cell Type" form can be used
to determine the conventional cell.  This is done by matching the current
reduced cell with entries from
Table 2 from the paper:  "Lattice Symmetry and Identification -- The 
Fundamental Role of Reduced Cells in Materials Characterization", Alan D. 
Mighell, Vol. 106, Number 6, Nov-Dec 2001, Journal of Research of the National 
Institute of Standards and Technology.  The error tolerance for matches
that will be listed can be specified using the "Max Error" field at the top 
of the form.  The types of cells and centering to be included can also 
be specified.  After changing the error tolerance or cell type restrictions,
press the "Update List" button to adjust the list of possible matches 
using the new error and/or cell type restrictions.  A possible choice can
be selected by entering the choice number on the form, or by stepping through
the list until the desired choice is visible.  Pressing the 
"Apply Displayed Cell" will transform the current orientation matrix to
correspond to the chosen conventional cell, and will index the peaks
using the new orientation matrix.
 
</P>



<P>
<FONT size=+1>Example Files</FONT>
<BR>
<BR>
It may be helpful to work with a couple of "nice" example data files
to get comfortable using IsawEV.  
<BR>
<BR>
The file SNAP_240_neutron_event.dat has data from a quartz crystal on SNAP.
The lattice parameters should be approximately a=b=4.913, c=5.40,
alpha=beta=90, gamma=120.

<BR>
<BR>
The file ARCS_419_neutron_event.dat has data from a silicon crystal on ARCS.
The lattice parameters should be approximately a=b=c=5.431, alpha=beta=gamma=90.

</P>


</BODY></HTML>
